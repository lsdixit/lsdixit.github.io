{
  "hash": "e96bf25430c87471dda197d5e25e3bff",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Determining optimal suitability in Exclusive Economic Zones (EEZ) on the West Coast of USA\"\nauthor: \n  - name: Leela Dixit\n    url: https://lsdixit.github.io/\n    affiliation: UCSB Master of Environmental Data Science\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science\ndate: \"December 5, 2025\"\nformat: html\neditor_options: \n  chunk_output_type: console\n---\n# Background\n\n![Credit: Saoysters](farm.JPG)(https://creativecommons.org/licenses/by/3.0/deed.en) \n\nMarine aquaculture has grown substantially globally and has both positive and negative economic, ecological, and sustainability potential. Gentry et al estimated global seafood demand could be met using less than 0.015% of global ocean area. The United States is among the top countries with large marine aquaculture potential, likely due to long coastlines and exclusive economic zones (sea area 200 nm from a coastal baseline in which a sovereign state has exclusive rights). In this study, we will develop a workflow to determine which exclusive economic zones (EEZ) are best suited for species of oysters and red abalone, based on suitable sea surface temperature and depth.\n\n\nLoad packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(tmap)\nlibrary(stars)\nlibrary(raster)\nlibrary(terra)\n```\n:::\n\n\nRead in data\n\n::: {.cell}\n\n```{.r .cell-code}\n# exclusive economic zones for west coast\neez <- st_read(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"wc_regions_clean.shp\"))\n\n# bathymetry\ndepth <- rast(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"depth.tif\"))\n\n# sea surface temperature\n# read in as a stack\nfilelist <- list.files(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"average_annual_sst\"), full.names = TRUE)\nsst <- rast(filelist)\n```\n:::\n\n\n## Step 1: Prepare the data\nCheck the CRS of all data and transform if needed. \n\n::: {.cell}\n\n```{.r .cell-code}\n# check crs for all data files\ncrs(sst, describe = TRUE)$code \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(eez)$epsg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4326\n```\n\n\n:::\n\n```{.r .cell-code}\ncrs(depth, describe = TRUE)$code\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"4326\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# transform sea surface temp to 4326\ncrs(sst) <- 'epsg:4326'\n# check again\nif (crs(sst, describe = TRUE)$code == st_crs(eez)$epsg) {\n  print(\"CRS match!\")\n} else {\n  stop(\"CRS do not match, must transform\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CRS match!\"\n```\n\n\n:::\n:::\n\n\n## Step 2: Process data\nClean sea surface temperature and depth data, including checking and transforming CRS, resolution, and extent.\n\n::: {.cell}\n\n```{.r .cell-code}\n# look at layer names\nnames(sst)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"average_annual_sst_2008\" \"average_annual_sst_2009\"\n[3] \"average_annual_sst_2010\" \"average_annual_sst_2011\"\n[5] \"average_annual_sst_2012\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# find the mean SST from all years\n# sst_avg <- app(sst, mean, na.rm = TRUE)\nsst_avg <- mean(sst)\nnames(sst_avg) # just one layer!\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"mean\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# convert sst from kelvin to celsius\nsst_avg <- sst_avg - 273.15\n\n# crop depth raster to the extent of sst \ndepth_crop <- crop(depth, floor(ext(sst_avg)))\n# check extents match \next(depth_crop) == ext(sst_avg) # they are very close, but extents don't match\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\n# resample depth data to match resolution to sst data\n# use nearest neighbor approach\ndepth_resample <- resample(depth_crop, sst_avg, method = \"near\")\n\n# check for match in resolution, extent, and crs\nif (res(sst_avg)[1] == res(depth_resample)[1] &\n    res(sst_avg)[2] == res(depth_resample)[2] &\n    ext(sst_avg) == ext(depth_resample) &\n    crs(sst_avg) == crs(depth_resample)){\n  print(\"Resolution, extent, and CRS match!\")\n} else {\n  stop(\"Resolution, extent, and/or CRS do not match.\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Resolution, extent, and CRS match!\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# combine depth and sst to make sure they match\ncheck_match <- c(depth_resample, sst_avg)\n```\n:::\n\n\n## Step 3: Find suitable locations\nFirst we will develop a workflow to find suitable locations for many species of oysters.\n\nIdeal Sea Surface Temperature : 11-30 Celsius \n\nIdeal Depth : 0-70 meters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# min max sst and depth are replaceable for a function\n# reclassify for suitable conditions\nrcl_sst <- matrix(c(-Inf, 11, 0,\n                    11, 30, 1, \n                    30, Inf, 0),\n                    ncol = 3, byrow = TRUE)\n\nrcl_depth <- matrix(c(-Inf, -70, 0,\n                      -70, 0, 1,\n                      0, Inf, 0),\n                      ncol = 3, byrow = TRUE)\n\n# reclassify per layer for each matrix\nsst_reclass <- classify(sst_avg, rcl_sst)\ndepth_reclass <- classify(depth_resample, rcl_depth)\n# check min and max are 0 and 1\nsummary(sst_reclass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      mean      \n Min.   :0.000  \n 1st Qu.:1.000  \n Median :1.000  \n Mean   :0.929  \n 3rd Qu.:1.000  \n Max.   :1.000  \n NA's   :42349  \n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(depth_reclass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     depth        \n Min.   :0.00000  \n 1st Qu.:0.00000  \n Median :0.00000  \n Mean   :0.01353  \n 3rd Qu.:0.00000  \n Max.   :1.00000  \n```\n\n\n:::\n\n```{.r .cell-code}\n# depth x sst will return only cells with both 1s as 1\nmultiplication_func <- function(x, y) {\n  x * y\n}\nsuitable_cells <- lapp(c(sst_reclass, depth_reclass), fun = multiplication_func)\n# check min and max are 0 and 1\nsummary(suitable_cells)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      lyr1      \n Min.   :0.000  \n 1st Qu.:0.000  \n Median :0.000  \n Mean   :0.008  \n 3rd Qu.:0.000  \n Max.   :1.000  \n NA's   :42349  \n```\n\n\n:::\n\n```{.r .cell-code}\n# create mask with EEZ so nothing too deep in the ocean and no on-land is returned\nsuitable_cells_west <- mask(suitable_cells, eez)\nsummary(suitable_cells_west)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      lyr1      \n Min.   :0.000  \n 1st Qu.:0.000  \n Median :0.000  \n Mean   :0.014  \n 3rd Qu.:0.000  \n Max.   :1.000  \n NA's   :74795  \n```\n\n\n:::\n\n```{.r .cell-code}\n# quick plot to check mask worked\nplot(suitable_cells)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(suitable_cells_west)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# how many cells are suitable in each zone\nsuitable_cells_west[suitable_cells_west == 0] <- NA\neez_rast <- rasterize(eez, y = suitable_cells_west, field = \"rgn_id\")\nsuitable_cells_west_zone <- zonal(suitable_cells_west, eez_rast, fun = \"notNA\")\nknitr::kable(suitable_cells_west_zone, format = \"html\", col.names = c(\"Region ID\", \"Suitable Cell Count\"), table.attr = 'data-quarto-disable-processing=\"true\"') %>% \n  kableExtra::kable_styling(bootstrap_options = c(\"basic\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table data-quarto-disable-processing=\"true\" class=\"table table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Region ID </th>\n   <th style=\"text-align:right;\"> Suitable Cell Count </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# find cell size of suitable cell areas\nsuitable_cell_area <- cellSize(suitable_cells_west, unit=\"km\")\nsummary(suitable_cell_area)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      area      \n Min.   :13.85  \n 1st Qu.:15.20  \n Median :16.45  \n Mean   :16.37  \n 3rd Qu.:17.58  \n Max.   :18.56  \n```\n\n\n:::\n\n```{.r .cell-code}\n# multiply against NAs to remove extra values\nsuitable_cell_area_values <- suitable_cell_area * suitable_cells_west\n# sum across zones to get total suitable area\ntotal_area <- zonal(suitable_cell_area_values, eez_rast, fun=\"sum\", na.rm = TRUE)\nknitr::kable(total_area, format = \"html\", \n             col.names = c(\"Region ID\", \"Total Suitable Area (km)\"), table.attr = 'data-quarto-disable-processing=\"true\"') %>% \n  kableExtra::kable_styling(bootstrap_options = c(\"basic\", \"hover\"), \n                            full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table data-quarto-disable-processing=\"true\" class=\"table table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Region ID </th>\n   <th style=\"text-align:right;\"> Total Suitable Area (km) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1074.2720 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 178.0268 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4069.8766 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3757.2849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2378.3137 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# join to spatial data to map\ntotal_area <- left_join(total_area, eez, by = \"rgn_id\")\ntotal_area <- st_as_sf(total_area)\n\n# map total area in each suitable zone\ntm_shape(total_area) +\n  tm_basemap(\"CartoDB.PositronNoLabels\") +\n  tm_polygons(fill = \"area\",\n              title = \"Suitable Area (km)\",\n              palette = \"-viridis\") +\n  tm_scalebar(breaks = c(0, 100, 200, 300),\n              position = c(\"left\", \"bottom\")) +\n  tm_compass(position = c(\"left\", \"bottom\")) +\n  tm_title(\"West Coast Suitable Area : Oysters\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n:::\n\n\n# Step 4: Create a reproducible workflow\nRed Abalone are a popular seafood delicacy and were farmed along the west coast of California prior to the fisheries closure 2018 following multiple ecological stressors leading to population declines. There are some farm operations for abalone on the west coast, and multiple restoration efforts in practice.\n\nWe will compile the workflow above into a function to recreate a figure for Red Abalone.\n\nIdeal Sea Surface Temperature : 8 - 18 Celsius\n\nIdeal Depth : 0 - 24 meters\n\n::: {.cell}\n\n```{.r .cell-code}\nsuitable_location <- function(sst_low, sst_high, depth_low, depth_high, species_name) {\n  # set up reclassification matrix\n  rcl_sst <- matrix(c(-Inf, sst_low, 0,\n                    sst_low, sst_high, 1, \n                    sst_high, Inf, 0),\n                    ncol = 3, byrow = TRUE)\n\n  rcl_depth <- matrix(c(-Inf, depth_low, 0,\n                      depth_low, depth_high, 1,\n                      depth_high, Inf, 0),\n                      ncol = 3, byrow = TRUE)\n  \n  # reclassify depth and sst data\n  sst_reclass <- classify(sst_avg, rcl_sst)\n  depth_reclass <- classify(depth_resample, rcl_depth)\n  \n  # multiply reclassified layers to return cells that are suitable for our species\n  multiplication_func <- function(x, y) {\n  x * y\n  }\n  suitable_cells <- lapp(c(sst_reclass, depth_reclass), fun = multiplication_func)\n  summary(suitable_cells)\n  \n  # create mask with EEZ so nothing too deep in the ocean and no on-land is returned\n  suitable_cells_west <- mask(suitable_cells, eez)\n  # set 0 cells to NA\n  suitable_cells_west[suitable_cells_west == 0] <- NA\n  \n  # find cell size of suitable cell areas\n  eez_rast <- rasterize(eez, y = suitable_cells_west, field = \"rgn_id\")\n  suitable_cell_area <- cellSize(suitable_cells_west, unit=\"km\")\n  # multiply against NAs to remove extra values\n  suitable_cell_area_values <- suitable_cell_area * suitable_cells_west\n  \n  # sum across zones to get total suitable area, and join with spatial data to map\n  total_area <- zonal(suitable_cell_area_values, eez_rast, fun=\"sum\", na.rm = TRUE)\n  total_area <- left_join(total_area, eez, by = \"rgn_id\")\n  total_area <- st_as_sf(total_area)\n  \n  # map suitable areas\n  tm_shape(total_area) +\n  tm_basemap(\"CartoDB.PositronNoLabels\") +\n  tm_polygons(fill = \"area\",\n              title = \"Suitable Area (km)\",\n              palette = \"-viridis\") +\n  tm_scalebar(breaks = c(0, 100, 200, 300),\n              position = c(\"left\", \"bottom\")) +\n  tm_compass(position = c(\"left\", \"bottom\")) +\n  tm_title(paste(\"West Coast Suitable Area :\", species_name))\n}\n\n\n# Run the function with suitable conditions for red abalone\nsuitable_location(sst_low = 8, \n                  sst_high = 18, \n                  depth_low = -24, \n                  depth_high = 0, \n                  species_name = \"Red Abalone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Step 5: Conclusions\nFor oysters, we can see the are on the west coast with the most suitable area is in the EEZ of the central area of California's coast, with the next highest in southern California. For red abalone, there is generally less total suitable area on the west coast but the EEZ with the most suitable area is in Washington, with the rest of the west coast being fairly comparable in suitable area.\n\nNative oysters, Olympia oysters for example, have a range that spreads all along the west coast. Their suitable EEZ areas make sense, with most of the area very close to shore where temperature and depth satisfies their ecological needs. Red abalone are also found along the entirety of the west coast, however with smaller suitable temperature and depth ranges, it makes sense they have a much smaller area of suitability. \n\nWhile these maps are very informative for finding areas of the west coast for potential farming or restoration, for example, they only describe a small portion of what makes an area suitable for a species. There can be factors such as habitat and food availability, insulation from extreme weather events, competition or predation, or other ecological and environmental attributes that can influence the suitability of an area.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}