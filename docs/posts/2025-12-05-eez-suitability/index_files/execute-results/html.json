{
  "hash": "cc379a64f08df7996a979fc77f4ab04c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Determining optimal suitability in Exclusive Economic Zones (EEZ) on the West Coast of USA\"\nauthor: \n  - name: Leela Dixit\n    url: https://lsdixit.github.io/\n    affiliation: UCSB Master of Environmental Data Science\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science\ndate: \"December 11, 2025\"\nformat: html\neditor_options: \n  chunk_output_type: console\n---\n\n# Background\n\n![](farm.JPG){fig-scap=\"Photo credit: Saoysters\"} [Creative License](https://creativecommons.org/licenses/by/3.0/deed.en)\n\nMarine aquaculture has grown substantially globally and has both positive and negative economic, ecological, and sustainability potential[^1]. Gentry et al[^2] estimated global seafood demand could be met using less than 0.015% of global ocean area. The United States is among the top countries with large marine aquaculture potential, likely due to long coastlines and exclusive economic zones[^3] (sea area 200 nm from a coastal baseline in which a sovereign state has exclusive rights).\n\n[^1]: Gentry, R. R., Alleway, H. K., Bishop, M. J., Gillies, C. L., Waters, T., & Jones, R. (2020). Exploring the potential for marine aquaculture to contribute to ecosystem services. *Reviews in Aquaculture*, *12*(2), 499-512.\n\n[^2]: Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. *Nature Ecology & Evolution*, 1, 1317-1324 (2017)\n\n[^3]: Gunnar Knapp & Michael C. Rubino (2016) The Political Economics of Marine Aquaculture in the United States, Reviews in Fisheries Science & Aquaculture, 24:3, 213-229, DOI: 10.1080/23308249.2015.1121202\n\n### Problem statement\n\nWith the rise of global seafood demand, we must leverage our marine aquaculture potential to meet the growing need. In order to maximize potential, we need to determine potential aquaculture locations based on optimizing habitat suitability for our aquaculture species of interest. In this study, we will develop a workflow to determine which exclusive economic zones (EEZ) are best suited for species of oysters and red abalone, two culturally and economically import species for seafood, based on suitable sea surface temperature and depth.\n\n# Data Sources\n\nInformation on optimal sea surface temperature and depth for red abalone were collected from [Sea Life Base](https://www.sealifebase.ca/search.php). Sea surface temperature from 2008-2012 were originally generated through [NOAA's Coral Reef Watch daily 5km SST anomalies](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php). Depth of the ocean was characterized with [General Bathymetric Chart of the Oceans (GEBCO](https://www.gebco.net/data-products/gridded-bathymetry-data#area). Maritime boundaries for exclusive economic zones (EEZ) were characterized by [marineregions.org](https://www.marineregions.org/eez.php)\n\nLoad packages.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(tmap)\nlibrary(stars)\nlibrary(raster)\nlibrary(terra)\n```\n:::\n\n\nRead in data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# exclusive economic zones for west coast\neez <- st_read(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"wc_regions_clean.shp\"))\n\n# bathymetry\ndepth <- rast(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"depth.tif\"))\n\n# sea surface temperature\n# read in as a stack\nfilelist <- list.files(here(\"posts\", \"2025-12-05-eez-suitability\", \"data\", \"average_annual_sst\"), full.names = TRUE)\nsst <- rast(filelist)\n```\n:::\n\n\n# Step 1: Prepare the data\n\nIn order to produce maps of our optimized suitable area for aquaculture, we need to clean and wrangle our data to be ready for analysis and visualizations. First, we will check the CRS of all data and transform if needed.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# check crs for all data files\ncrs(sst, describe = TRUE)$code \nst_crs(eez)$epsg\ncrs(depth, describe = TRUE)$code\n\n# transform sea surface temp to 4326\ncrs(sst) <- 'epsg:4326'\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# check again\nif (crs(sst, describe = TRUE)$code == st_crs(eez)$epsg) {\n  print(\"CRS match!\")\n} else {\n  stop(\"CRS do not match, must transform\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CRS match!\"\n```\n\n\n:::\n:::\n\n\n\n# Step 2: Process data\n\nNow that our data match in CRS, we can clean sea surface temperature and depth data, including converting from kelvin to celsius, cropping our depth data to the extent of our sea surface temperature data, and resampling our depth data to match the resolution of our sea surface temperature data. This is a necessary step in order to accurately calculate optimal locations for aquaculture, and to produce maps of those locations.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# look at layer names\nnames(sst)\n\n# find the mean SST from all years\n# sst_avg <- app(sst, mean, na.rm = TRUE)\nsst_avg <- mean(sst)\nnames(sst_avg) # just one layer!\n\n# convert sst from kelvin to celsius\nsst_avg <- sst_avg - 273.15\n\n# crop depth raster to the extent of sst \ndepth_crop <- crop(depth, floor(ext(sst_avg)))\n# check extents match \next(depth_crop) == ext(sst_avg) # they are very close, but extents don't match\n\n# resample depth data to match resolution to sst data\n# use nearest neighbor approach\ndepth_resample <- resample(depth_crop, sst_avg, method = \"near\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# check for match in resolution, extent, and crs\nif (res(sst_avg)[1] == res(depth_resample)[1] &\n    res(sst_avg)[2] == res(depth_resample)[2] &\n    ext(sst_avg) == ext(depth_resample) &\n    crs(sst_avg) == crs(depth_resample)){\n  print(\"Resolution, extent, and CRS match!\")\n} else {\n  stop(\"Resolution, extent, and/or CRS do not match.\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Resolution, extent, and CRS match!\"\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# combine depth and sst to make sure they match\ncheck_match <- c(depth_resample, sst_avg)\n```\n:::\n\n\n# Step 3: Find suitable locations\n\nWe will categorize a suitable location as an area that satisfies conditions for both ideal sea surface temperature and ideal depth for our species.\n\nFirst we will develop a workflow to find suitable locations for Oysters.\n\n| Metric                  | Range   |\n|-------------------------|---------|\n| Sea Surface Temperature | 11-30 C |\n| Depth                   | 0-70 m  |\n\n## Part 1: Reclassify\n\nFor both our sea surface temperature and depth raster, we need to assign each cell a `0` or `1` based on whether it is in the suitable range for Oysters or not.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# min max sst and depth are replaceable for a function\n# reclassify for suitable conditions\nrcl_sst <- matrix(c(-Inf, 11, 0,\n                    11, 30, 1, \n                    30, Inf, 0),\n                    ncol = 3, byrow = TRUE)\n\nrcl_depth <- matrix(c(-Inf, -70, 0,\n                      -70, 0, 1,\n                      0, Inf, 0),\n                      ncol = 3, byrow = TRUE)\n\n# reclassify per layer for each matrix\nsst_reclass <- classify(sst_avg, rcl_sst)\ndepth_reclass <- classify(depth_resample, rcl_depth)\n# check min and max are 0 and 1\nsst_min <- global(sst_reclass, min, na.rm = TRUE)$min\nsst_max <- global(sst_reclass, max, na.rm = TRUE)$max\ndepth_min <- global(depth_reclass, min, na.rm = TRUE)$min\ndepth_max <- global(depth_reclass, max, na.rm = TRUE)$max\n```\n:::\n\n\nWe can check if our reclassification worked by checking the min and max of each raster.\n\n| Metric                  | Min           | Max           |\n|-------------------------|---------------|---------------|\n| Sea Surface Temperature | 0   | 1   |\n| Depth                   | 0 | 1 |\n\n## Part 2: Calculate suitable cells and mask\nNow that our data are in 0s and 1s, we can calculate our ideal locations by multiplying our sea surface temperature raster with our depth raster. If there is a 1 in both (i.e a suitable location) our resulting raster will have a 1. If there is a zero in one, or both, it will result in a 0 indicating it is not a suitable location.\n\nAfter finding all cells in our raster that are suitable for oysters, we will mask that raster to the extent of our exclusive economic zones, as that is where the highest potential of marine aquaculture would occur. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# depth x sst will return only cells with both 1s as 1\nmultiplication_func <- function(x, y) {\n  x * y\n}\nsuitable_cells <- lapp(c(sst_reclass, depth_reclass), fun = multiplication_func)\n\n# create mask with EEZ so nothing too deep in the ocean and no on-land is returned\nsuitable_cells_west <- mask(suitable_cells, eez)\n\n# quick plot to check mask worked\nmap_suitable <- tm_shape(suitable_cells) +\n  tm_raster(breaks = c(0,1,2),\n            labels = c(\"Not Suitable\", \"Suitable\"),\n            title = \"Suitable Locations\") +\n  tm_title(\"U.S. west coast: total area\") +\n  tm_scalebar() +\n  tm_compass()\nmap_suitable_eez <- tm_shape(suitable_cells_west) +\n  tm_raster(breaks = c(0,1,2),\n            labels = c(\"Not Suitable\", \"Suitable\"),\n            title = \"Suitable Locations\") +\n  tm_title(\"U.S. west coast: EEZ area\") +\n  tm_scalebar() +\n  tm_compass()\n\ntmap_arrange(map_suitable, map_suitable_eez, nrow = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nWe can see we've cut out any areas that might have been on land, and all areas in the deeper ocean and outside of the U.S. EEZ zones. All areas that were deemed suitable for Oysters based on sea surface temperature and depth are shaded in darker blue, congregating generally right along the coastline. \n\n## Part 3: Calculate suitable area and map\nWe can use this smaller EEZ area to now calculate in km2 the area in each exclusive economic zone that would be suitable for oyster aquaculture. Another way to maximize our aquaculture potential is to hone in on the area of the west coast with the most suitable area for our species of interest. It is not realistic to assume aquaculture for one species can occupy the entire west coast, so by narrowing the scope to the most suitable areas we can ensure the best chance of survival of our species, likely leading to a more profitable aquaculture outcome.\n\nWe will count the cells we calculated as suitable in the previous part, and multiply that value by the size in km2 of each cell. We will then visualize these values on a map of each EEZ. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# how many cells are suitable in each zone\nsuitable_cells_west[suitable_cells_west == 0] <- NA\neez_rast <- rasterize(eez, y = suitable_cells_west, field = \"rgn_id\")\nsuitable_cells_west_zone <- zonal(suitable_cells_west, eez_rast, fun = \"notNA\")\nknitr::kable(suitable_cells_west_zone, \n             caption = \"Total suitable cells\", \n             #format = \"html\", \n             col.names = c(\"Region ID\", \"Suitable Cell Count\"), \n             table.attr = 'data-quarto-disable-processing=\"true\"') %>% \n  kableExtra::kable_styling(bootstrap_options = c(\"basic\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Total suitable cells</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Region ID </th>\n   <th style=\"text-align:right;\"> Suitable Cell Count </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# find cell size of suitable cell areas\nsuitable_cell_area <- cellSize(suitable_cells_west, unit=\"km\")\n\n# multiply against NAs to remove extra values\nsuitable_cell_area_values <- suitable_cell_area * suitable_cells_west\n# sum across zones to get total suitable area\ntotal_area <- zonal(suitable_cell_area_values, eez_rast, fun=\"sum\", na.rm = TRUE)\nknitr::kable(total_area, \n             #format = \"html\",\n             caption = \"Total suitable area (km2)\",\n             col.names = c(\"Region ID\", \"Total Suitable Area (km)\"), \n             table.attr = 'data-quarto-disable-processing=\"true\"') %>% \n  kableExtra::kable_styling(bootstrap_options = c(\"basic\", \"hover\"), \n                            full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Total suitable area (km2)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Region ID </th>\n   <th style=\"text-align:right;\"> Total Suitable Area (km) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1074.2720 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 178.0268 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4069.8766 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3757.2849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2378.3137 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# join to spatial data to map\ntotal_area <- left_join(total_area, eez, by = \"rgn_id\")\ntotal_area <- st_as_sf(total_area)\n```\n:::\n\n\nIn our map, we can see the 5 EEZ areas split along the west coast of the United States, and the EEZ with the largest area of suitable habitat is in the central coast of California, following by the southern coast of California. If we, for example, want to maximize our potential for oyster aquaculture on the west coast of the United States, these areas may be the most ideal in terms of habitat suitability for oysters.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# map total area in each suitable zone\ntm_shape(total_area) +\n  tm_basemap(\"CartoDB.PositronNoLabels\") +\n  tm_polygons(fill = \"area\",\n              title = \"Suitable Area (km)\",\n              palette = \"-viridis\") +\n  tm_scalebar(breaks = c(0, 100, 200, 300),\n              position = c(\"left\", \"bottom\")) +\n  tm_compass(position = c(\"left\", \"bottom\")) +\n  tm_title(\"West Coast Suitable Area : Oysters\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n# Step 4: Create a reproducible workflow\n\nRed Abalone are a popular seafood delicacy, and were farmed along the west coast of California prior to the fisheries closure in 2018 following multiple ecological stressors, ultimately leading to population declines. There are some farm operations for red abalone on the west coast, and multiple restoration efforts in practice.\n\nWe will compile the workflow above into a function to recreate a similar figure for Red Abalone.\n\n| Metric                  | Range   |\n|-------------------------|---------|\n| Sea Surface Temperature | 8-18 C |\n| Depth                   | 0-24 m  |\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsuitable_location <- function(sst_low, sst_high, depth_low, depth_high, species_name) {\n  # set up reclassification matrix\n  rcl_sst <- matrix(c(-Inf, sst_low, 0,\n                    sst_low, sst_high, 1, \n                    sst_high, Inf, 0),\n                    ncol = 3, byrow = TRUE)\n\n  rcl_depth <- matrix(c(-Inf, depth_low, 0,\n                      depth_low, depth_high, 1,\n                      depth_high, Inf, 0),\n                      ncol = 3, byrow = TRUE)\n  \n  # reclassify depth and sst data\n  sst_reclass <- classify(sst_avg, rcl_sst)\n  depth_reclass <- classify(depth_resample, rcl_depth)\n  \n  # multiply reclassified layers to return cells that are suitable for our species\n  multiplication_func <- function(x, y) {\n  x * y\n  }\n  suitable_cells <- lapp(c(sst_reclass, depth_reclass), fun = multiplication_func)\n  summary(suitable_cells)\n  \n  # create mask with EEZ so nothing too deep in the ocean and no on-land is returned\n  suitable_cells_west <- mask(suitable_cells, eez)\n  # set 0 cells to NA\n  suitable_cells_west[suitable_cells_west == 0] <- NA\n  \n  # find cell size of suitable cell areas\n  eez_rast <- rasterize(eez, y = suitable_cells_west, field = \"rgn_id\")\n  suitable_cell_area <- cellSize(suitable_cells_west, unit=\"km\")\n  # multiply against NAs to remove extra values\n  suitable_cell_area_values <- suitable_cell_area * suitable_cells_west\n  \n  # sum across zones to get total suitable area, and join with spatial data to map\n  total_area <- zonal(suitable_cell_area_values, eez_rast, fun=\"sum\", na.rm = TRUE)\n  total_area <- left_join(total_area, eez, by = \"rgn_id\")\n  total_area <- st_as_sf(total_area)\n  \n  # map suitable areas\n  tm_shape(total_area) +\n  tm_basemap(\"CartoDB.PositronNoLabels\") +\n  tm_polygons(fill = \"area\",\n              title = \"Suitable Area (km)\",\n              palette = \"-viridis\") +\n  tm_scalebar(breaks = c(0, 100, 200, 300),\n              position = c(\"left\", \"bottom\")) +\n  tm_compass(position = c(\"left\", \"bottom\")) +\n  tm_title(paste(\"West Coast Suitable Area :\", species_name))\n}\n```\n:::\n\n\nHere we can see a very similar map to our previous map of oysters, with different values in each EEZ where it is now suitable locations for red abalone. We were able to condense all 3 parts of our previous workflow for oysters into a function that only requires parameters of ideal suitable conditions (sea surface temperature range, depth range, and species name). As long as you have that information, you can recreate this suitability map for any species of interest. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Run the function with suitable conditions for red abalone\nsuitable_location(sst_low = 8, \n                  sst_high = 18, \n                  depth_low = -24, \n                  depth_high = 0, \n                  species_name = \"Red Abalone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n# Step 5: Conclusions\n\nFor oysters, we can see the area on the west coast with the most suitable area is in the EEZ of the central area of California's coast, with the next highest in southern California. For red abalone, there is generally less total suitable area on the west coast but the EEZ with the most suitable area is in Washington, with the rest of the west coast being fairly comparable in suitable area.\n\nNative oysters, Olympia oysters for example, have a range that spreads all along the west coast. Their suitable EEZ areas make sense, with most of the area very close to shore where temperature and depth satisfies their ecological needs. Red abalone are also found along the entirety of the west coast, however with smaller suitable temperature and depth ranges, it makes sense they have a much smaller area of suitability.\n\nWhile these maps are very informative for finding areas of the west coast for potential farming or restoration, for example, they only describe a small portion of what makes an area suitable for a species. There can be factors such as habitat and food availability, insulation from extreme weather events, competition or predation, or other ecological and environmental attributes that can influence the suitability of an area. However, they are an excellent first step to determine areas for future marine aquaculture, and a step forward in achieving our goal of leveraging our unique marine aquaculture potential in the U.S. to meet the growing seafood demand. \n\n# Citations\n\n-   Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & Oâ€™Keefe, M. Blue Frontiers: Managing the Environmental Costs of Aquaculture (The WorldFish Center, Penang, Malaysia, 2011).\n-   Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. Nature Ecology & Evolution, 1, 1317-1324 (2017).\n-   NOAA Coral Reef Watch Daily Global 5km Satellite Coral Bleaching Heat Stress SST Anomaly Product (Version 3.1). (n.d.). Coralreefwatch.noaa.gov. https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php.\n-   Search SeaLifeBase. (n.d.). Www.sealifebase.ca. https://www.sealifebase.ca/search.php.\n-   Marine Regions. (n.d.). Www.marineregions.org. https://www.marineregions.org/eez.php\n-   GEBCO Compilation Group (2022) GEBCO_2022 Grid (doi:10.5285/e0f0bb80-ab44-2739-e053-6c86abc0289c).\n-   Gentry, R. R., Alleway, H. K., Bishop, M. J., Gillies, C. L., Waters, T., & Jones, R. (2020). Exploring the potential for marine aquaculture to contribute to ecosystem services. *Reviews in Aquaculture*, *12*(2), 499-512.\n-   Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. *Nature Ecology & Evolution*, 1, 1317-1324 (2017)\n-   Gunnar Knapp & Michael C. Rubino (2016) The Political Economics of Marine Aquaculture in the United States, Reviews in Fisheries Science & Aquaculture, 24:3, 213-229, DOI: 10.1080/23308249.2015.1121202\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}